{% extends 'chem21/base_learning.html' %}
{% load tokens %}
{% load admin_urls %}
{% block title %} {{ object.title }} :: {{ current_module.title }} :: CHEM21 learning platform{% endblock %}
{% block display_title %}{% if current_module.dummy %}{{ current_module.topic.title }} {% else %} {{ current_module.title }} {% endif %}: {{ object.title }}{% endblock %}
{% block class_nav %}
<div class="item-list">
	<ol>
	{% for module in class_tree.modules.all|dictsort:"order" %}
		{% ifequal module current_module %}
			{% if module.dummy %}
				{% include 'chem21/include/active_module_nav.html' with module=module current_lesson=object %}
			{% else %}
			<li class="active">
				{% if module.text|striptags or perms.repo.change_module %}
					<a href="{{ module.get_absolute_url }}">{{ module.name }}</a>
				{% else %}
					{{ module.name }}
				{% endif %}
				<ol>
				{% include 'chem21/include/active_module_nav.html' with module=module current_lesson=object %}
				</ol>
			</li>
			{% endif %}
			
		{% else %}
			{% if module.dummy %}
			{% include 'chem21/include/active_module_nav.html' with module=module current_lesson=object %}
			{% else %}
			<li><a href="{{ module.get_absolute_url }}">{{ module.name }}</a></li>
			{% endif %}
		{% endifequal %}
	{% endfor %}
	</ol>
</div>  
{% endblock %}
{% block admin_tools %}
{% if perms.repo.change_lesson %}
{% if object.is_question %}
		<a class="admin-edit" href="{% url opts.question|admin_urlname:'change' object.first_question.pk %}"
		data-from-url-edit="{% url opts.question|admin_urlname:'changelist' %}">
		Edit</a>
		{% if object.first_question.video %}
			<a class="admin-edit" href="{% url opts.uniquefile|admin_urlname:'change' object.first_question.video.pk %}"
			data-from-url-edit="{% url opts.uniquefile|admin_urlname:'changelist' %}">Edit video attributes</a>
		{% endif %}
{% else %}
		<a class="admin-edit" href="{% url opts.lesson|admin_urlname:'change' object.pk %}"
		data-from-url-edit="{% url opts.lesson|admin_urlname:'changelist' %}">
		Edit</a>
{% endif %}
{% endif %}
{% endblock %}